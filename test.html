<!doctype html>
<html>
    <head>
        <title>Upload Test</title>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="lib/webfs.js"></script>
        <script type="text/javascript" src="lib/webfs-util.js"></script>
    </head>
    
    <body>
        <form id="u" method="post" action=".">
            <input type="file" id="uploadfile" />
            <br />
            <input type="submit" />
        </form>
        <div id="progress"></div>
        
        <script type="text/javascript">
        
        webkitRequestFileSystem(TEMPORARY, 1024*1024*1024, function(fileSystemHandler) {
            var fs = new WebFS(fileSystemHandler);
            
            $('#u').submit(function(e) {
                progressText = '';
                e.preventDefault();
                var file = $('#uploadfile')[0].files[0];
            
                fs.writeFile(file.fileName, file, null, function(handler) {
                    console.log(handler);
                }, function(progress) {
                    $('#progress').text(progress.loaded + '/' + progress.total);
                });
                return false;
            });
            
        }, function(error) {
            console.log(error);
        });
        
        </script>
    </body>
</html>